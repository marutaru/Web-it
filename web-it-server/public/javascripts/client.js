// Generated by CoffeeScript 1.4.0
(function() {

  $(function() {
    var selected_num, socket;
    selected_num = null;
    socket = io.connect("http://localhost");
    socket.on("connect", function() {
      socket.on("init", function(cards) {
        $("img:not(#field)").click(function() {
          console.log("select card");
          $("img").css("border", "0px");
          $(this).css("border", "inset 2px #ff0000");
          if (this.id !== "field") {
            console.log(selected_num);
            return selected_num = this.id;
          } else {
            return console.log("select another");
          }
        });
        return $("#field").click(function(e) {
          console.log("select position");
          if (selected_num !== null) {
            cards[selected_num].destination.x = e.pageX;
            cards[selected_num].destination.y = e.pageY;
            return socket.emit("update destination", cards[selected_num]);
          } else {
            return console.log("selected_num = null");
          }
        });
      });
      return socket.on("all cards", function(cards) {
        var card, _i, _len, _results;
        _results = [];
        for (_i = 0, _len = cards.length; _i < _len; _i++) {
          card = cards[_i];
          $("." + card.id).css("position", "absolute").css("left", "" + card.current.x + "px").css("top", "" + card.current.y + "px");
          _results.push($("span." + card.id).text(card.hp));
        }
        return _results;
      });
    });
    $('div').append("<img id='field' src='images/field.jpg'></img>");
    $('div').append("<img id='0' class='0' src='images/0.jpg' width='50'></img>").append("<span class='0'>100</span>");
    $('div').append("<img id='1' class='1' src='images/1.jpg' width='50'></img>").append("<span class='1'>100</span>");
    $('div').append("<img id='2' class='2' src='images/2.jpg' width='50'></img>").append("<span class='2'>100</span>");
    $('div').append("<img id='3' class='3' src='images/3.jpg' width='50'></img>").append("<span class='3'>100</span>");
    return $('div').append("<img id='4' class='4' src='images/4.jpg' width='50'></img>").append("<span class='4'>100</span>");
  });

}).call(this);
